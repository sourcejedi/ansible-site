- hosts: alan-laptop
  roles:
    - repos-fedora

    - sourcejedi.etckeeper
    - remove-rpcbind
    - sourcejedi.hdparm-noapm
    - users
    - sourcejedi.systemd-journal

    - systemd-coredump

    # This works ok, though it doesn't mark the file
    # as modified automatically by ansible
    - role: tersmitten.sysctl
      sysctl_settings:
        #
        # https://fedoraproject.org/wiki/QA/Sysrq
        #
        # Fedora disables sysrq by default.
        # It's slightly more powerful than some people are comfortable with
        # granting to not-logged-in users :).
        # But I want it.
        #
        - name: kernel.sysrq
          value: 1

    # Useful to log memory usage per process (default 10 min snapshots).
    - sourcejedi.atop

    # My Dell Latitude E5450 seems ok with `powertop --auto-tune`.
    #
    # except that it causes occasional hangs soon after resume
    # (test period: 1-3 weeks)
    #
    # re-happened now?
    # 2017-12-16  4.14.3-300.fc27  2017-12-11 
    # previous    4.13.16-302.fc27  2017-12-02
    #
    # ALPM is still disabled
    #
    #- powertop-full-override

    - remove-mlocate-on-fedora
    - packages-trash-cli
    - jpegcheck
    - packages-gui

    - packages-dev-basics
    - sourcejedi.ccache

    - sourcejedi.rpmfusion-free  # e.g. codecs beyond mp3

    # nonfree, useful at least to keep the repo keys updated for other users.
    #- sourcejedi.rpmfusion-nonfree
    - { role: sourcejedi.rpmfusion-remove, repo: nonfree }

    - sourcejedi.nspawn-on-fedora
